writer.js:163: WARNING - "instanceof" with left non-object operand is always false.
  if ((!strings instanceof Array))
       ^

0 error(s), 1 warning(s)
var assert=require("assert"),ASN1=require("./types"),errors=require("./errors"),newInvalidAsn1Error=errors.newInvalidAsn1Error,DEFAULT_OPTS={size:1024,growthFactor:8};function merge(a,b){assert.ok(a);assert.equal(typeof a,"object");assert.ok(b);assert.equal(typeof b,"object");Object.getOwnPropertyNames(a).forEach(function(c){if(!b[c]){var d=Object.getOwnPropertyDescriptor(a,c);Object.defineProperty(b,c,d)}});return b}
function Writer(a){a=merge(DEFAULT_OPTS,a||{});this._buf=new Buffer(a.size||1024);this._size=this._buf.length;this._offset=0;this._options=a;this._seq=[];var b=this;this.__defineGetter__("buffer",function(){if(b._seq.length)throw new InvalidAsn1Error(b._seq.length+" unended sequence(s)");return b._buf.slice(0,b._offset)})}Writer.prototype.writeByte=function(a){if("number"!==typeof a)throw new TypeError("argument must be a Number");this._ensure(1);this._buf[this._offset++]=a};
Writer.prototype.writeInt=function(a,b){if("number"!==typeof a)throw new TypeError("argument must be a Number");"number"!==typeof b&&(b=ASN1.Integer);for(var c=4;(0===(a&4286578688)||4286578688===(a&4286578688))&&1<c;)c--,a<<=8;if(4<c)throw new InvalidAsn1Error("BER ints cannot be > 0xffffffff");this._ensure(2+c);this._buf[this._offset++]=b;for(this._buf[this._offset++]=c;0<c--;)this._buf[this._offset++]=(a&4278190080)>>24,a<<=8};Writer.prototype.writeNull=function(){this.writeByte(ASN1.Null);this.writeByte(0)};
Writer.prototype.writeEnumeration=function(a,b){if("number"!==typeof a)throw new TypeError("argument must be a Number");"number"!==typeof b&&(b=ASN1.Enumeration);return this.writeInt(a,b)};Writer.prototype.writeBoolean=function(a,b){if("boolean"!==typeof a)throw new TypeError("argument must be a Boolean");"number"!==typeof b&&(b=ASN1.Boolean);this._ensure(3);this._buf[this._offset++]=b;this._buf[this._offset++]=1;this._buf[this._offset++]=a?255:0};
Writer.prototype.writeString=function(a,b){if("string"!==typeof a)throw new TypeError("argument must be a string (was: "+typeof a+")");"number"!==typeof b&&(b=ASN1.OctetString);var c=Buffer.byteLength(a);this.writeByte(b);this.writeLength(c);c&&(this._ensure(c),this._buf.write(a,this._offset),this._offset+=c)};
Writer.prototype.writeBuffer=function(a,b){if("number"!==typeof b)throw new TypeError("tag must be a number");if(!Buffer.isBuffer(a))throw new TypeError("argument must be a buffer");this.writeByte(b);this.writeLength(a.length);this._ensure(a.length);a.copy(this._buf,this._offset,0,a.length);this._offset+=a.length};Writer.prototype.writeStringArray=function(a){if(!a instanceof Array)throw new TypeError("argument must be an Array[String]");var b=this;a.forEach(function(a){b.writeString(a)})};
Writer.prototype.writeOID=function(a,b){if("string"!==typeof a)throw new TypeError("argument must be a string");"number"!==typeof b&&(b=ASN1.OID);if(!/^([0-9]+\.){3,}[0-9]+$/.test(a))throw Error("argument is not a valid OID string");var c=a.split("."),d=[];d.push(40*parseInt(c[0],10)+parseInt(c[1],10));c.slice(2).forEach(function(a){a=parseInt(a,10);128>a?d.push(a):(16384>a?d.push(a>>>7|128):(2097152>a?d.push(a>>>14|128):(268435456>a?d.push(a>>>21|128):(d.push((a>>>28|128)&255),d.push((a>>>21|128)&
255)),d.push((a>>>14|128)&255)),d.push((a>>>7|128)&255)),d.push(a&127))});var e=this;this._ensure(2+d.length);this.writeByte(b);this.writeLength(d.length);d.forEach(function(a){e.writeByte(a)})};
Writer.prototype.writeLength=function(a){if("number"!==typeof a)throw new TypeError("argument must be a Number");this._ensure(4);if(127>=a)this._buf[this._offset++]=a;else if(255>=a)this._buf[this._offset++]=129,this._buf[this._offset++]=a;else if(65535>=a)this._buf[this._offset++]=130,this._buf[this._offset++]=a>>8,this._buf[this._offset++]=a;else if(16777215>=a)this._shift(start,a,1),this._buf[this._offset++]=131,this._buf[this._offset++]=a>>16,this._buf[this._offset++]=a>>8,this._buf[this._offset++]=
a;else throw new InvalidAsn1ERror("Length too long (> 4 bytes)");};Writer.prototype.startSequence=function(a){"number"!==typeof a&&(a=ASN1.Sequence|ASN1.Constructor);this.writeByte(a);this._seq.push(this._offset);this._ensure(3);this._offset+=3};
Writer.prototype.endSequence=function(){var a=this._seq.pop(),b=a+3,c=this._offset-b;if(127>=c)this._shift(b,c,-2),this._buf[a]=c;else if(255>=c)this._shift(b,c,-1),this._buf[a]=129,this._buf[a+1]=c;else if(65535>=c)this._buf[a]=130,this._buf[a+1]=c>>8,this._buf[a+2]=c;else if(16777215>=c)this._shift(b,c,1),this._buf[a]=131,this._buf[a+1]=c>>16,this._buf[a+2]=c>>8,this._buf[a+3]=c;else throw new InvalidAsn1Error("Sequence too long");};
Writer.prototype._shift=function(a,b,c){assert.ok(void 0!==a);assert.ok(void 0!==b);assert.ok(c);this._buf.copy(this._buf,a+c,a,a+b);this._offset+=c};Writer.prototype._ensure=function(a){assert.ok(a);if(this._size-this._offset<a){var b=this._size*this._options.growthFactor;b-this._offset<a&&(b+=a);a=new Buffer(b);this._buf.copy(a,0,0,this._offset);this._buf=a;this._size=b}};module.exports=Writer; //# sourceMappingURL=writer.js.map
