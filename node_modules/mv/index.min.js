var fs=require("fs"),ncp=require("ncp").ncp,path=require("path"),rimraf=require("rimraf"),mkdirp=require("mkdirp");module.exports=mv;
function mv(b,d,f,c){function h(){mkdirp(path.dirname(d),function(a){if(a)return c(a);k()})}function k(){e?fs.rename(b,d,function(a){if(!a)return c();if("EXDEV"!==a.code)return c(a);moveFileAcrossDevice(b,d,e,g,c)}):fs.link(b,d,function(a){a?"EXDEV"===a.code?moveFileAcrossDevice(b,d,e,g,c):"EISDIR"===a.code||"EPERM"===a.code?moveDirAcrossDevice(b,d,e,g,c):c(a):fs.unlink(b,c)})}"function"===typeof f&&(c=f,f={});var e=!1!==f.clobber,g=f.limit||16;f.mkdirp?h():k()}
function moveFileAcrossDevice(b,d,f,c,h){function k(){fs.unlink(b,h)}var e=f?"w":"wx",g=fs.createReadStream(b),a=fs.createWriteStream(d,{flags:e});g.on("error",function(e){g.destroy();a.destroy();a.removeListener("close",k);"EISDIR"===e.code||"EPERM"===e.code?moveDirAcrossDevice(b,d,f,c,h):h(e)});a.on("error",function(b){g.destroy();a.destroy();a.removeListener("close",k);h(b)});a.once("close",k);g.pipe(a)}
function moveDirAcrossDevice(b,d,f,c,h){function k(){ncp(b,d,e,function(g){if(g)return h(g[0]);rimraf(b,{disableGlob:!0},h)})}var e={stopOnErr:!0,clobber:!1,limit:c};f?rimraf(d,{disableGlob:!0},function(b){if(b)return h(b);k()}):k()}; //# sourceMappingURL=index.js.map
